!function e(t,n,o){function r(a,c){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!c&&u)return u(a,!0);if(i)return i(a,!0);var s=new Error("Cannot find module '"+a+"'");throw s.code="MODULE_NOT_FOUND",s}var l=n[a]={exports:{}};t[a][0].call(l.exports,function(e){var n=t[a][1][e];return r(n?n:e)},l,l.exports,e,t,n,o)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)r(o[a]);return r}({1:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e){console.log(e),I.getElementsByTagName("message")[0].innerHTML=""+e.message,I.getElementsByTagName("stack")[0].innerHTML=""+c(e.stack),D.style.display="flex"}function c(e){return e.replace(/&/g,"&amp;").replace(N,function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1);return"&#"+(1024*(t-55296)+(n-56320)+65536)+";"}).replace(F,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function u(e){var t=document.getElementById("not-capable"),n=document.getElementById("capable");t.style.display="flex",n.style.display="none",t.appendChild(document.createTextNode(e))}function s(){/android/i.test(navigator.userAgent)&&!function(){var e=parseInt(localStorage.getItem("androidMessageCount"));isNaN(e)&&(e=3),e>0&&!function(){var t=document.getElementsByTagName("android")[0],n=t.getElementsByTagName("close")[0];t.style.display="flex",e--,0===e?n.innerHTML="Don't Remind Me Again":1===e?n.innerHTML="Remind Me At Least 1 More Time":n.innerHTML="Remind Me At Least "+e+" More Times",n.close=function(){return t.style.display="none",localStorage.setItem("androidMessageCount",e),!1}}()}()}function l(e,t){for(var n=t.attach(e),o=0;o<e.children.length;o++)l(e.children[o],n)}function d(e){function t(e){Y.cycleBarEffect()}function n(e){}function o(e,t){u=setTimeout(function(){var e=l?l[0]:d;i(e.clientX,e.clientY),u=void 0},125)}function r(e){return u&&(clearTimeout(u),s(e),u=void 0),a(e)}function i(e,t){return c.style.display="flex",c.style.left=e-c.clientWidth/2+"px",c.style.top=t-c.clientHeight/2+"px",!1}function a(e){return c.style.display="none",!1}var c=e.getElementsByTagName("menu")[0],u=void 0,s=void 0,l=void 0,d=void 0;e.onmousedown=function(e){return 0===e.button&&(s=t,o(e.clientX,e.clientY)),!1},e.oncontextmenu=function(e){return Y.cycleBarEffect(!0),!1},e.ontouchstart=function(e){if(1===e.touches.length){var t=S(e.touches,1),r=t[0],i=r.clientX,a=r.clientY;s=n,o(i,a)}return!1},e.ontouchend=r,e.onmouseup=r,e.onmousemove=function(e){d=e},e.ontouchmove=function(e){l=e.touches}}function f(e){console.log(e.keyCode);var t=ce[e.keyCode];if(t)return t(e)}function h(e){return new Promise(function(t,n){return navigator.getUserMedia(e,t,n)})}function g(e){function t(){var e=(new Date).getTime()-o,n=e%1e3,r=Math.floor(e/1e3),i=r%60,a=Math.floor(r/60)%60,c=Math.floor(e/6e4),u=Math.floor(c/60);return W.innerHTML=u,Z.innerHTML=a,$.innerHTML=i,J.innerHTML=n<100?n<10?"00"+n:"0"+n:n,t}var n=new Le(e,le),o=n.recording.start;return ze.push(t),ke=function(){var e=arguments.length<=0||void 0===arguments[0]?o:arguments[0],t=e-o;t<0&&(t=0)},{recorder:n,stream:e,data:be}}function v(e){var t=e.stream,n=e.data,o=e.lastSaveTime,r=_.createMediaStreamSource(t),i=_.createAnalyser();_.sampleRate;i.smoothingTimeConstant=de,m(i,me.value,Y),y(we.value);var a=_.createGain();a.gain.value=1,r.connect(a),a.connect(i),V.cycleBarCount=function(e){return e?me.goBackward():me.goForward(),m(i,me.value,Y),!1},Y.cycleBarEffect=function(e){return Y.classList.remove(pe.value),e?pe.goBackward():pe.goForward(),Y.classList.add(pe.value),!1};var c=!1,u={x:0,y:0},s={x:0,y:0},l=void 0;return V.mouseDown=function(e){c=!0,u.x=s.x=e.clientX,u.y=s.y=e.clientY,l=setTimeout(function(){c&&G.classList.add("visible"),l=void 0},125)},V.mouseUp=function(e){c=!1,G.classList.remove("visible"),0===e.button&&l&&(clearTimeout(l),Y.classList.toggle("vertical"),l=void 0)},V.mouseMove=function(e){({x:e.clientX-u.x,y:e.clientY-u.y})},V.touchStart=function(e){return c=!0,u.x=s.x=e.clientX,u.y=s.y=e.clientY,l=setTimeout(function(){c&&G.classList.add("visible"),l=void 0},125),Y.cycleBarEffect(),!1},V.touchEnd=function(e){return c=!1,G.classList.remove("visible"),l&&(clearTimeout(l),l=void 0),!1},X.mouseDown=function(e){console.log("mouseDown",e)},X.mouseUp=function(e){0===e.button&&!function(){var t="SLICE"===e.target.tagName?e.target:e.target.parentNode;ze.push(function(){De.mover&&De.mover.classList.remove("mover"),De.start&&De.start.classList.remove("start"),De.end&&De.end.classList.remove("end"),De.start=De.mover=t,De.end=X.children[Math.max(0,X.children.length-Ne)],De.start.classList.add("start"),De.end.classList.add("end"),De.mover.classList.add("mover")}),ke(t.approximateTime)}()},{stream:t,data:n,lastSaveTime:o,analyser:i}}function m(e,t,n){var o=Math.max(32,Math.min(32768,4*t));e.fftSize=o;var r=e.frequencyBinCount,i=Math.min(r/2,t);be=new Uint8Array(r/2),i>Me.length?Ie.split(Me,i):Ie.combine(Me,i),Me.splice(i);for(var a=n.children.length;a<i;a++)n.appendChild(document.createElement("div"));for(var c=n.children.length-1;c>=i;c--)n.children[c].remove();se.setParameters(4,we.value,me.value)}function y(e){console.log(e),se.setParameters(4,e,me.value)}function w(e){function t(){var e=(new Date).getTime();if(Ae=e,Re=o.context.currentTime,o.getByteFrequencyData(be),e-Ee>ye.value){Ne<te.width&&Ne++,Ne===te.width&&Fe.view++,Fe.data++;for(var r=0;r<Me.length;r++)Me[r]=0;se.finishSlice(),xe=1,Ee=e}var i=""===Y.className||Y.classList.contains("left")||Y.classList.contains("right"),a=0,c=Y.children.length;if(1===c){var u=Y.children[0],s=be[0]+be[1]+be[2]+be[3]+be[4]+be[5]+be[6]+be[7],l=s/8;Ie.add(Me,0,l),n(i,u,l)}else if(2===c)for(var d=0;d<Y.children.length;d++){var f=Y.children[d],h=be[4*d]+be[4*d+1]+be[4*d+2]+be[4*d+3],g=h/4;a+=g,Ie.add(Me,d,g),n(i,f,g)}else if(4===c)for(var v=0;v<Y.children.length;v++){var m=Y.children[v],y=be[2*v]+be[2*v+1],w=y/2;a+=w,Ie.add(Me,v,w),n(i,m,w)}else for(var p=0;p<Y.children.length;p++){var b=Y.children[p],x=be[p];a+=x,Ie.add(Me,p,x),n(i,b,x)}var E=te.width-(Ne+Fe.view)%te.width-1;ae[E]=Ee,se.setSlice(Me),se.drawTo(oe,re,we.value);var M=a/Y.children.length;return Y.style.backgroundColor="rgba("+M+", "+M+", "+M+", 1)",xe++,t}function n(e,t,n){t.style.backgroundColor="rgba("+n+", "+n+", "+n+", 1)";var o=n/255*100+"%";e?(t.style.width=o,t.style.height="auto"):(t.style.width="auto",t.style.height=o)}var o=e.analyser;Ee=(new Date).getTime(),P.classList.add("granted"),j.classList.add("authorized"),M(oe,re),ze.push(t),b(),console.log(o)}function p(){function e(){ze.push(function(){for(var e=K.clientWidth,t=K.clientHeight/qe,o=0;o<qe;o++){var r=n[o];M(r.canvas,r,e,t),console.log(e,t)}})}var t=void 0,n=[];return function(){if(0===K.children.length){j.classList.add("storage");for(var o=K.clientWidth,r=K.clientHeight/qe,i=0;i<qe;i++){var a=se.createView(),c=a.canvas,u=a.context;K.appendChild(c),M(c,u,o,r),n.push(u)}window.addEventListener("resize",e),t=function(){for(var e=0;e<n.length;e++){var o=n[e];o.drawImage(te,(qe-e-1)*(te.width/qe),0,te.width/qe,te.height,0,0,o.canvas.width,o.canvas.height)}return t},ze.push(t)}else{t=void 0;for(var s=K.children.length-1;s>=0;s--)K.removeChild(K.children[s]);n.splice(0),j.classList.remove("storage"),window.removeEventListener("resize",e)}}}function b(){requestAnimationFrame(x)}function x(){function e(e){var t=e.map(function(e){return e()});e.splice(0),e.push.apply(e,r(t.filter(function(e){return"function"==typeof e})))}e(ze),b()}function E(e){a(e)}function M(e,t,n,o){var r=e.parentElement;e.width=void 0===n?r.clientWidth:n,e.height=void 0===o?r.clientHeight:o,console.log(e.width,e.height),T(t)}function T(e){e.imageSmoothingEnabled=!1,e.mozImageSmoothingEnabled=!1,e.webkitImageSmoothingEnabled=!1,e.msImageSmoothingEnabled=!1}var S=function(){function e(e,t){var n=[],o=!0,r=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(o=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);o=!0);}catch(u){r=!0,i=u}finally{try{!o&&c["return"]&&c["return"]()}finally{if(r)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},B=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),k=e("./cycle"),C=o(k),I=document.getElementsByTagName("error-details")[0],D=document.getElementsByTagName("error-display")[0];window.addEventListener("error",function(e){return a(e.error)});var N=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,F=/([^\#-~| |!])/g;try{navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;var A=window.AudioContext||window.webkitAudioContext;navigator.getUserMedia||u("No getUserMedia!"),navigator.mediaDevices||u("No mediaDevices!"),A||u("No AudioContext!"),MediaRecorder||u("No MediaRecorder!")}catch(R){u(R)}s();var q=function(){function e(t){function n(e){for(var t in e){var r=e[t];"object"===("undefined"==typeof r?"undefined":L(r))&&(r=n(r));var i=t.replace(/([a-zA-Z])(?=[A-Z])/g,"$1-").toUpperCase();e[i]=o(i,r)}return e}function o(e,t){return function(n,o){return t(n,o,e),o}}i(this,e),this.context=n(t)}return B(e,[{key:"attach",value:function(e){var t=e.tagName,n=this.context[t];return n?n(e,this):this}}]),e}(),z=new q({notCapable:function(e,t){console.log("not-capable",e,t)},capable:function(e,t){console.log("capable",e,t)}});l(document.body,z);var U=window.indexedDB.open("dist.lol"),H=void 0;U.onerror=function(e){console.log("error opening request",e,U)},U.onsuccess=function(e){console.log("request open",e,U),H=U.result},U.onupgradeneeded=function(e){console.log("needs upgrade",e),e.target.result.createObjectStore("recordings",{autoIncrement:!0})};var _=new AudioContext,P=document.getElementById("no-permission"),j=document.getElementById("authorized"),O=(P.children[1],document.getElementsByTagName("upper")[0]),V=O.getElementsByTagName("recent")[0],Y=V.getElementsByTagName("nodes")[0],X=document.getElementById("history"),G=(document.getElementById("time"),document.getElementById("recent-menu")),W=document.getElementsByTagName("hours")[0],Z=document.getElementsByTagName("minutes")[0],$=document.getElementsByTagName("seconds")[0],J=document.getElementsByTagName("milliseconds")[0],K=document.getElementsByTagName("storage-panel")[0],Q=document.getElementsByTagName("lower")[0];d(O),d(Q),O.onmousewheel=function(e){return V.cycleBarCount(e.deltaY<0)},O.onwheel=function(e){return V.cycleBarCount(e.deltaY<0)};var ee=document.createElement("audio");document.body.insertBefore(ee,document.body.firstChild);var te=document.createElement("canvas"),ne=te.getContext("2d"),oe=document.createElement("canvas"),re=oe.getContext("2d"),ie=ne.createImageData(1,1),ae=(ie.data,[]);X.appendChild(oe),ne.imageSmoothingEnabled=!1,re.imageSmoothingEnabled=!1,window.addEventListener("resize",function(e){return M(oe,re)}),X.addEventListener("resize",function(e){return M(oe,re)}),window.addEventListener("keyup",f);var ce={66:function(e){te.parentElement?te.parentElement.removeChild(te):(j.appendChild(te),setTimeout(function(){return T(ne)},1e3))}};oe.addEventListener("click",function(e){var t=Math.floor(e.offsetX/oe.width*te.width);console.log(t,ae[t])});var ue=function(){function e(t){i(this,e),this.canvas=t,this.context=t.getContext("2d"),this.pixel=this.context.createImageData(1,1),this.pixelData=this.pixel.data,this.views=[],t.className="buffer-canvas"}return B(e,[{key:"createView",value:function(){var e=document.createElement("canvas"),t=e.getContext("2d");return{canvas:e,context:t}}},{key:"createMovingView",value:function(){}},{key:"updateViews",value:function(){for(var e=0;e<this.views.length;e++)shouldUpdate(this.views[e])&&update(this.views[e])}},{key:"setSize",value:function(e,t){M(this.canvas,this.context,e,t)}},{key:"setParameters",value:function(e,t,n){console.log("parameters",e,t,n),this.setSize((e+1)*t,n),this.nextSliceIndex=this.canvas.width-1}},{key:"setSlice",value:function(e){for(var t=this.canvas,n=this.context,o=this.nextSliceIndex,r=this.pixel,i=this.pixelData,a=0;a<t.height;a++){var c=Ie.getValue(e,e.length-1-a);i[0]=c,i[1]=c,i[2]=c,i[3]=255,n.putImageData(r,o,a)}}},{key:"finishSlice",value:function(e){e&&this.setSlice(e),this.nextSliceIndex=(0===this.nextSliceIndex?this.canvas.width:this.nextSliceIndex)-1}},{key:"drawTo",value:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?1:arguments[2],o=Math.min(n,this.canvas.width-this.nextSliceIndex),r=this.canvas.width-o;r>0&&t.drawImage(this.canvas,0,0,r,this.canvas.height,r,0,r,e.height),t.drawImage(this.canvas,this.nextSliceIndex,0,o,this.canvas.height,0,0,e.width,e.height)}}]),e}(),se=new ue(te);h({audio:!0}).then(g).then(v).then(w)["catch"](E);var le=3e4,de=.66,fe=new C["default"]([1,2,4,8,16,32,64,128,256,512,1024,2048,4096,8192]),he=new C["default"]([1e3,500,250,125,62.5,31.25,15.625,7.8125]),ge=new C["default"]([60,90,120,150,180,240,300,500,1e3,1500]),ve=["left","top","right","bottom"],me=fe.create(),ye=he.create(),we=ge.create(),pe=new C["default"](ve).create(),be=void 0,xe=0,Ee=void 0,Me=[],Te=function(){function e(){i(this,e),this.recordings=[]}return B(e,[{key:"addRecording",value:function(e){var t=e.start,n=e.blob;this.recordings.push([t,n]);try{!function(){var e=H.transaction(["recordings"],"readwrite");e.oncomplete=function(e){return console.log("complete",e)},e.onerror=function(t){return console.log("error",t,e)};var o=e.objectStore("recordings"),r=o.add({start:t,blob:n});r.onsuccess=function(e){return console.log("success",e,r)}}()}catch(o){!function(){var e=new FileReader;e.onload=function(){var n=H.transaction(["recordings"],"readwrite");n.oncomplete=function(e){return console.log("complete",e)},n.onerror=function(e){return console.log("error",e,n)};var o=n.objectStore("recordings"),r=o.add({start:t,data:e.result});r.onsuccess=function(e){return console.log("success",e,r)}},e.readAsDataURL(n),console.log("saved "+t)}()}}}]),e}(),Se=new Te,Le=function(){function e(t,n){i(this,e),this.recording=this._startRecording(t,n)}return B(e,[{key:"_startRecording",value:function(e,t){var n=this,o=new Be(new MediaRecorder(e),t);return o.recordingEnding=function(){n.otherRecording=n._startRecording(e,t)},o.onDurationMet=function(){Se.addRecording(n.recording),n.recording=n.otherRecording},o}}]),e}(),Be=function(){function e(t,n){var o=this;i(this,e),this.recorder=t,this.duration=n,this.start=(new Date).getTime(),this.data=[],t.addEventListener("dataavailable",function(e){e.data.size>0&&o.data.push(e.data);var t=(new Date).getTime();t-o.start>n&&"recording"===o.recorder.state&&(o.recordingEnding(),o.recorder.stop()),o.waitingForData&&o.waitingForData()}),t.addEventListener("stop",function(e){o.onDurationMet()}),t.start(2e3)}return B(e,[{key:"getLatestBlob",value:function(){var e=this;return this.blobPromise||(this.blobPromise=new Promise(function(t,n){e.waitingForData=function(){e.blobPromise=void 0,e.waitingForData=void 0,t(e.blob)},e.recorder.requestData()})),this.blobPromise}},{key:"blob",get:function(){return 0===this.data.length?this._blob:(this._blob=this._blob?new Blob([this._blob].concat(this.data)):new Blob(this.data),this.data.splice(0),this._blob)}}]),e}(),ke=void 0,Ce={mean:{split:function(e,t){for(var n=Math.log2(t)-Math.log2(e.length||1),o=Math.pow(2,n),r=0;r<t/o;r++){var i=(e[r]/o||0)/(xe||1);e[o*r]=i,e[o*r+1]=i}xe=1},combine:function(e,t){for(var n=Math.log2(e.length||1)-Math.log2(t||1),o=Math.pow(2,n),r=0;r<e.length;r++){for(var i=0,a=0;a<o;a++)i+=e[r*a+a];e[r]=i/o}},add:function(e,t,n){e[t]+=n},getValue:function(e,t){return e[t]/xe}},max:{split:function(e,t){},combine:function(e,t){},add:function(e,t,n){e[t]=Math.max(e[t]||0,n)},getValue:function(e,t){return e[t]}},min:{split:function(){},combine:function(){},add:function(e,t,n){e[t]=Math.min(e[t]||255,n)},getValue:function(e,t){return e[t]}}},Ie=Ce.mean,De={mover:void 0,start:void 0,end:void 0},Ne=0,Fe={data:0,view:0},Ae=void 0,Re=void 0;window.requestFullScreen=function(){console.log("going full",document.body),document.body.requestFullScreen?document.body.requestFullScreen():document.body.webkitRequestFullScreen?document.body.webkitRequestFullScreen():document.body.mozRequestFullScreen?document.body.mozRequestFullScreen():document.body.msRequestFullScreen&&document.body.msRequestFullScreen()},window.cycleHistorySize=function(e){e?we.goBackward():we.goForward(),y(we.value)},window.cycleAccumulationPeriod=function(){return ye.goForward(),!1},window.wheel=function(e){console.log("wheel",e)},window.toggleStorage=p();var qe=4;document.body.addEventListener("webkitfullscreenchange",function(e){document.body.classList.toggle("fullscreen")}),document.onfullscreenchange=function(e){console.log("fullscreen"),document.body.classList.toggle("fullscreen")},document.onmozfullscreenchange=function(e){document.body.classList.toggle("fullscreen")};var ze=[]},{"./cycle":2}],2:[function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=function(){function e(t){o(this,e),this.values=t}return r(e,[{key:"create",value:function(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0];return new a(this,e)}}]),e}();n["default"]=i;var a=function(){function e(t){var n=arguments.length<=1||void 0===arguments[1]?0:arguments[1];o(this,e),this.cycle=t,this.valueIndex=n}return r(e,[{key:"goBackward",value:function(){return this.valueIndex=(0===this.valueIndex?this.cycle.values.length:this.valueIndex)-1,this.value}},{key:"goForward",value:function(){return this.valueIndex=(this.valueIndex+1)%this.cycle.values.length,this.value}},{key:"value",get:function(){return this.cycle.values[this.valueIndex]}}]),e}()},{}]},{},[1]);
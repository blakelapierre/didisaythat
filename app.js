!function e(t,n,o){function r(a,c){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!c&&u)return u(a,!0);if(i)return i(a,!0);var s=new Error("Cannot find module '"+a+"'");throw s.code="MODULE_NOT_FOUND",s}var l=n[a]={exports:{}};t[a][0].call(l.exports,function(e){var n=t[a][1][e];return r(n?n:e)},l,l.exports,e,t,n,o)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)r(o[a]);return r}({1:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e){console.log(e),console.dir(e),"SecurityError"===e.name&&"http"===window.location.protocol?(A.getElementsByTagName("message")[0].innerHTML=""+e.message,A.getElementsByTagName("stack")[0].innerHTML="Attempting to load over https...",R.style.display="flex",window.location.href=window.location.href.replace(/^http/,"https")):(A.getElementsByTagName("message")[0].innerHTML=""+e.message,A.getElementsByTagName("stack")[0].innerHTML=""+c(e.stack),R.style.display="flex")}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.replace(/&/g,"&amp;").replace(q,function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1);return"&#"+(1024*(t-55296)+(n-56320)+65536)+";"}).replace(P,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function u(e){var t=document.getElementById("not-capable"),n=document.getElementById("capable");t.style.display="flex",n.style.display="none",t.appendChild(document.createTextNode(e))}function s(){/android/i.test(navigator.userAgent)&&!function(){var e=parseInt(localStorage.getItem("androidMessageCount"));isNaN(e)&&(e=3),e>0&&!function(){var t=document.getElementsByTagName("android")[0],n=t.getElementsByTagName("close")[0];t.style.display="flex",e--,0===e?n.innerHTML="Don't Remind Me Again":1===e?n.innerHTML="Remind Me At Least 1 More Time":n.innerHTML="Remind Me At Least "+e+" More Times",n.close=function(){return t.style.display="none",localStorage.setItem("androidMessageCount",e),!1}}()}()}function l(e,t){for(var n=t.attach(e),o=0;o<e.children.length;o++)l(e.children[o],n)}function d(e){function t(e){Z.cycleBarEffect()}function n(e){}function o(e,t){u=setTimeout(function(){var e=l?l[0]:d;i(e.clientX,e.clientY),u=void 0},125)}function r(e){return u&&(clearTimeout(u),s(e),u=void 0),a(e)}function i(e,t){return c.style.display="flex",c.style.left=e-c.clientWidth/2+"px",c.style.top=t-c.clientHeight/2+"px",!1}function a(e){return c.style.display="none",!1}var c=e.getElementsByTagName("menu")[0],u=void 0,s=void 0,l=void 0,d=void 0;e.onmousedown=function(e){return console.log("container mouse down"),0===e.button&&(s=t,o(e.clientX,e.clientY)),!1},e.oncontextmenu=function(e){return Z.cycleBarEffect(!0),!1},e.ontouchstart=function(e){if(1===e.touches.length){var t=B(e.touches,1),r=t[0],i=r.clientX,a=r.clientY;s=n,o(i,a)}return!1},e.ontouchend=r,e.onmouseup=r,e.onmousemove=function(e){d=e},e.ontouchmove=function(e){l=e.touches}}function f(e){console.log(e.keyCode);var t=de[e.keyCode];if(t)return t(e)}function h(e){return new Promise(function(t,n){return navigator.getUserMedia(e,t,n)})}function g(e){function t(){var e=(new Date).getTime()-o,n=e%1e3,r=Math.floor(e/1e3),i=r%60,a=Math.floor(r/60)%60,c=Math.floor(e/6e4),u=Math.floor(c/60);return K.innerHTML=u,Q.innerHTML=a,ee.innerHTML=i,te.innerHTML=n<100?n<10?"00"+n:"0"+n:n,t}var n=new Ie(e,ge),o=n.recording.start;return _e.push(t),Ne=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,t=e-o;console.log("playback",e,t,o),t<0&&(t=0)},{recorder:n,stream:e,data:Te}}function v(e){var t=e.stream,n=e.data,o=e.lastSaveTime,r=Y.createMediaStreamSource(t),i=Y.createAnalyser();Y.sampleRate;i.smoothingTimeConstant=ve,m(i,be.value,Z),y(Ee.value);var a=Y.createGain();a.gain.value=1,r.connect(a),a.connect(i),W.cycleBarCount=function(e){return e?be.goBackward():be.goForward(),m(i,be.value,Z),!1},Z.cycleBarEffect=function(e){return Z.classList.remove(Me.value),e?Me.goBackward():Me.goForward(),Z.classList.add(Me.value),!1};var c=!1,u={x:0,y:0},s={x:0,y:0},l=void 0;return W.mouseDown=function(e){c=!0,u.x=s.x=e.clientX,u.y=s.y=e.clientY,l=setTimeout(function(){c&&J.classList.add("visible"),l=void 0},125)},W.mouseUp=function(e){c=!1,J.classList.remove("visible"),0===e.button&&l&&(clearTimeout(l),Z.classList.toggle("vertical"),l=void 0)},W.mouseMove=function(e){({x:e.clientX-u.x,y:e.clientY-u.y})},W.touchStart=function(e){return c=!0,u.x=s.x=e.clientX,u.y=s.y=e.clientY,l=setTimeout(function(){c&&J.classList.add("visible"),l=void 0},125),Z.cycleBarEffect(),!1},W.touchEnd=function(e){return c=!1,J.classList.remove("visible"),l&&(clearTimeout(l),l=void 0),!1},$.onmousedown=function(e){return console.log("mouseDown",e),e.stopPropagation(),!1},$.onmouseup=function(e){console.log("mouseUp"),0===e.button&&!function(){var t="SLICE"===e.target.tagName?e.target:e.target.parentNode;_e.push(function(){console.log(Ae),Ae.mover&&Ae.mover.classList.remove("mover"),Ae.start&&Ae.start.classList.remove("start"),Ae.end&&Ae.end.classList.remove("end"),Ae.start=Ae.mover=t,Ae.end=$.children[Math.max(0,$.children.length-Re)],Ae.start&&Ae.start.classList.add("start"),Ae.end&&Ae.end.classList.add("end"),Ae.mover&&Ae.mover.classList.add("mover")}),Ne(t.approximateTime),e.stopPropagation()}()},$.oncontextmenu=function(e){return e.stopPropagation(),cycleAccumulationPeriod()},$.onmousewheel=function(e){return cycleHistorySize(e.deltaY<0)},$.onwheel=function(e){return cycleHistorySize(e.deltaY<0)},{stream:t,data:n,lastSaveTime:o,analyser:i}}function m(e,t,n){var o=Math.max(32,Math.min(32768,4*t));e.fftSize=o;var r=e.frequencyBinCount,i=Math.min(r/2,t);Te=new Uint8Array(r/2),i>Be.length?Fe.split(Be,i):Fe.combine(Be,i),Be.splice(i);for(var a=n.children.length;a<i;a++)n.appendChild(document.createElement("div"));for(var c=n.children.length-1;c>=i;c--)n.children[c].remove();he.setParameters(4,Ee.value,be.value)}function y(e){console.log(e),he.setParameters(4,e,be.value)}function p(e,t,n){for(var o=0;o<t;o++){var r=Z.children[o],i=He[n](Te,1===t?0:2===t?4*o:4===t?2*o:o);Fe.add(Be,o,i),w(e,r,Math.round(i))}}function w(e,t,n){t.style.backgroundColor="rgba("+n+", "+n+", "+n+", 1)";var o=n/255*100+"%";e?(t.style.width=o,t.style.height="auto"):(t.style.width="auto",t.style.height=o)}function b(e){function t(){var e=(new Date).getTime();if(Pe=e,ze=n.context.currentTime,n.getByteFrequencyData(Te),e-Le>xe.value){Re<ie.width&&Re++,Re===ie.width&&qe.view++,qe.data++;for(var o=0;o<Be.length;o++)Be[o]=0;he.finishSlice(),Se=1,Le=e}var r=""===Z.className||Z.classList.contains("left")||Z.classList.contains("right"),i=0,a=Z.children.length;p(r,Z.children.length,Math.max(1,8/a));var c=ie.width-(Re+qe.view)%ie.width-1;le[c]=Le,he.setSlice(Be),he.drawTo(ce,ue,Ee.value);var u=i/Z.children.length;return Z.style.backgroundColor="rgba("+u+", "+u+", "+u+", 1)",Se++,t}var n=e.analyser;Le=(new Date).getTime(),V.classList.add("granted"),X.classList.add("authorized"),S(ce,ue),_e.push(t),E(),console.log(n)}function x(){function e(){_e.push(function(){for(var e=ne.clientWidth,t=ne.clientHeight/Ue,o=0;o<Ue;o++){var r=n[o];S(r.canvas,r,e,t),console.log(e,t)}})}var t=void 0,n=[];return function(){if(0===ne.children.length){X.classList.add("storage");for(var o=ne.clientWidth,r=ne.clientHeight/Ue,i=0;i<Ue;i++){var a=he.createView(),c=a.canvas,u=a.context;ne.appendChild(c),S(c,u,o,r),n.push(u)}window.addEventListener("resize",e),t=function(){for(var e=0;e<n.length;e++){var o=n[e];o.drawImage(ie,(Ue-e-1)*(ie.width/Ue),0,ie.width/Ue,ie.height,0,0,o.canvas.width,o.canvas.height)}return t},_e.push(t)}else{t=void 0;for(var s=ne.children.length-1;s>=0;s--)ne.removeChild(ne.children[s]);n.splice(0),X.classList.remove("storage"),window.removeEventListener("resize",e)}}}function E(){requestAnimationFrame(M)}function M(){function e(e){var t=e.map(function(e){return e()});e.splice(0),e.push.apply(e,r(t.filter(function(e){return"function"==typeof e})))}e(_e),E()}function T(e){a(e)}function S(e,t,n,o){var r=e.parentElement;e.width=void 0===n?r.clientWidth:n,e.height=void 0===o?r.clientHeight:o,console.log(e.width,e.height),L(t)}function L(e){e.imageSmoothingEnabled=!1,e.webkitImageSmoothingEnabled=!1,e.msImageSmoothingEnabled=!1}var B=function(){function e(e,t){var n=[],o=!0,r=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(o=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);o=!0);}catch(u){r=!0,i=u}finally{try{!o&&c["return"]&&c["return"]()}finally{if(r)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),I=e("./cycle"),N=o(I),D=e("./recording"),F=o(D),A=document.getElementsByTagName("error-details")[0],R=document.getElementsByTagName("error-display")[0];window.addEventListener("error",function(e){return a(e.error)});var q=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,P=/([^\#-~| |!])/g;try{navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;var z=window.AudioContext||webkitAudioContext;navigator.getUserMedia||u("No getUserMedia!"),navigator.mediaDevices||u("No mediaDevices!"),z||u("No AudioContext!"),MediaRecorder||u("No MediaRecorder!")}catch(H){u(H)}s();var U=function(){function e(t){function n(e){for(var t in e){var r=e[t];"object"===("undefined"==typeof r?"undefined":k(r))&&(r=n(r));var i=t.replace(/([a-zA-Z])(?=[A-Z])/g,"$1-").toUpperCase();e[i]=o(i,r)}return e}function o(e,t){return function(n,o){return t(n,o,e),o}}i(this,e),this.context=n(t)}return C(e,[{key:"attach",value:function(e){var t=e.tagName,n=this.context[t];return n?n(e,this):this}}]),e}(),_=new U({notCapable:function(e,t){console.log("not-capable",e,t)},capable:function(e,t){console.log("capable",e,t)}});l(document.body,_);var j=window.indexedDB.open("dist.lol"),O=void 0;j.onerror=function(e){console.log("error opening request",e,j)},j.onsuccess=function(e){console.log("request open",e,j),O=j.result},j.onupgradeneeded=function(e){console.log("needs upgrade",e),e.target.result.createObjectStore("recordings",{autoIncrement:!0})};var Y=new AudioContext,V=document.getElementById("no-permission"),X=document.getElementById("authorized"),G=(V.children[1],document.getElementsByTagName("upper")[0]),W=G.getElementsByTagName("recent")[0],Z=W.getElementsByTagName("nodes")[0],$=document.getElementById("history"),J=(document.getElementById("time"),document.getElementById("recent-menu")),K=document.getElementsByTagName("hours")[0],Q=document.getElementsByTagName("minutes")[0],ee=document.getElementsByTagName("seconds")[0],te=document.getElementsByTagName("milliseconds")[0],ne=document.getElementsByTagName("storage-panel")[0],oe=document.getElementsByTagName("lower")[0];d(G),d(oe),G.onmousewheel=function(e){return W.cycleBarCount(e.deltaY<0)},G.onwheel=function(e){return W.cycleBarCount(e.deltaY<0)};var re=document.createElement("audio");document.body.insertBefore(re,document.body.firstChild);var ie=document.createElement("canvas"),ae=ie.getContext("2d"),ce=document.createElement("canvas"),ue=ce.getContext("2d"),se=ae.createImageData(1,1),le=(se.data,[]);$.appendChild(ce),ae.imageSmoothingEnabled=!1,ue.imageSmoothingEnabled=!1,window.addEventListener("resize",function(e){return S(ce,ue)}),$.addEventListener("resize",function(e){return S(ce,ue)}),window.addEventListener("keyup",f);var de={66:function(e){ie.parentElement?ie.parentElement.removeChild(ie):(X.appendChild(ie),setTimeout(function(){return L(ae)},1e3))}};ce.addEventListener("click",function(e){var t=Math.floor(e.offsetX/ce.width*ie.width);console.log(t,le[t])});var fe=function(){function e(t){i(this,e),this.canvas=t,this.context=t.getContext("2d"),this.pixel=this.context.createImageData(1,1),this.pixelData=this.pixel.data,this.views=[],t.className="buffer-canvas"}return C(e,[{key:"createView",value:function(){var e=document.createElement("canvas"),t=e.getContext("2d");return{canvas:e,context:t}}},{key:"createMovingView",value:function(){}},{key:"updateViews",value:function(){for(var e=0;e<this.views.length;e++)shouldUpdate(this.views[e])&&update(this.views[e])}},{key:"setSize",value:function(e,t){S(this.canvas,this.context,e,t)}},{key:"setParameters",value:function(e,t,n){console.log("parameters",e,t,n),this.setSize((e+1)*t,n),this.nextSliceIndex=this.canvas.width-1}},{key:"setSlice",value:function(e){for(var t=this.canvas,n=this.context,o=this.nextSliceIndex,r=this.pixel,i=this.pixelData,a=0;a<t.height;a++){var c=Fe.getValue(e,e.length-1-a);i[0]=c,i[1]=c,i[2]=c,i[3]=255,n.putImageData(r,o,a)}}},{key:"finishSlice",value:function(e){e&&this.setSlice(e),this.nextSliceIndex=(0===this.nextSliceIndex?this.canvas.width:this.nextSliceIndex)-1}},{key:"drawTo",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=Math.min(n,this.canvas.width-this.nextSliceIndex),r=this.canvas.width-o;r>0&&t.drawImage(this.canvas,0,0,r,this.canvas.height,r,0,e.width,e.height),t.drawImage(this.canvas,this.nextSliceIndex,0,o,this.canvas.height,0,0,e.width,e.height)}}]),e}(),he=new fe(ie);h({audio:!0}).then(g).then(v).then(b)["catch"](T);var ge=3e4,ve=.66,me=new N["default"]([1,2,4,8,16,32,64,128,256,512,1024,2048,4096,8192]),ye=new N["default"]([1e3,500,250,125,62.5,31.25,15.625,7.8125]),pe=new N["default"]([60,90,120,150,180,240,300,500,1e3,1500]),we=["left","top","right","bottom"],be=me.create(),xe=ye.create(),Ee=pe.create(),Me=new N["default"](we).create(),Te=void 0,Se=0,Le=void 0,Be=[],ke=function(){function e(){i(this,e),this.recordings=[]}return C(e,[{key:"addRecording",value:function(e){var t=e.start,n=e.blob;this.recordings.push([t,n]);try{!function(){var e=O.transaction(["recordings"],"readwrite");e.oncomplete=function(e){return console.log("complete",e)},e.onerror=function(t){return console.log("error",t,e)};var o=e.objectStore("recordings"),r=o.add({start:t,blob:n});r.onsuccess=function(e){return console.log("success",e,r)}}()}catch(o){!function(){var e=new FileReader;e.onload=function(){var n=O.transaction(["recordings"],"readwrite");n.oncomplete=function(e){return console.log("complete",e)},n.onerror=function(e){return console.log("error",e,n)};var o=n.objectStore("recordings"),r=o.add({start:t,data:e.result});r.onsuccess=function(e){return console.log("success",e,r)}},e.readAsDataURL(n),console.log("saved "+t)}()}}}]),e}(),Ce=new ke,Ie=function(){function e(t,n){i(this,e),this.recording=this._startRecording(t,n)}return C(e,[{key:"_startRecording",value:function(e,t){var n=this,o=new F["default"](new MediaRecorder(e),t);return o.recordingEnding=function(){n.otherRecording=n._startRecording(e,t)},o.onDurationMet=function(){Ce.addRecording(n.recording),n.recording=n.otherRecording},o}}]),e}(),Ne=void 0,De={mean:{split:function(e,t){for(var n=Math.log2(t)-Math.log2(e.length||1),o=Math.pow(2,n),r=0;r<t/o;r++){var i=(e[r]/o||0)/(Se||1);e[o*r]=i,e[o*r+1]=i}Se=1},combine:function(e,t){for(var n=Math.log2(e.length||1)-Math.log2(t||1),o=Math.pow(2,n),r=0;r<e.length;r++){for(var i=0,a=0;a<o;a++)i+=e[r*a+a];e[r]=i/o}},add:function(e,t,n){e[t]+=n},getValue:function(e,t){return e[t]/Se}},max:{split:function(e,t){},combine:function(e,t){},add:function(e,t,n){e[t]=Math.max(e[t]||0,n)},getValue:function(e,t){return e[t]}},min:{split:function(){},combine:function(){},add:function(e,t,n){e[t]=Math.min(e[t]||255,n)},getValue:function(e,t){return e[t]}}},Fe=De.mean,Ae={mover:void 0,start:void 0,end:void 0},Re=0,qe={data:0,view:0},Pe=void 0,ze=void 0,He=[];He[8]=function(e,t){return(e[t]+e[t+1]+e[t+2]+e[t+3]+e[t+4]+e[t+5]+e[t+6]+e[t+7])/8},He[4]=function(e,t){return(e[t]+e[t+1]+e[t+2]+e[t+3])/4},He[2]=function(e,t){return(e[t]+e[t+1])/2},He[1]=function(e,t){return e[t]},window.requestFullScreen=function(){console.log("going full",document.body),document.body.requestFullScreen?document.body.requestFullScreen():document.body.webkitRequestFullScreen?document.body.webkitRequestFullScreen():document.body.mozRequestFullScreen?document.body.mozRequestFullScreen():document.body.msRequestFullScreen&&document.body.msRequestFullScreen()},window.cycleHistorySize=function(e){e?Ee.goBackward():Ee.goForward(),y(Ee.value)},window.cycleAccumulationPeriod=function(){return xe.goForward(),!1},window.wheel=function(e){console.log("wheel",e)},window.toggleStorage=x();var Ue=4;document.body.addEventListener("webkitfullscreenchange",function(e){document.body.classList.toggle("fullscreen")}),document.onfullscreenchange=function(e){console.log("fullscreen"),document.body.classList.toggle("fullscreen")},document.onmozfullscreenchange=function(e){document.body.classList.toggle("fullscreen")};var _e=[]},{"./cycle":2,"./recording":3}],2:[function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=function(){function e(t){o(this,e),this.values=t}return r(e,[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new a(this,e)}}]),e}();n["default"]=i;var a=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;o(this,e),this.cycle=t,this.valueIndex=n}return r(e,[{key:"goBackward",value:function(){return this.valueIndex=(0===this.valueIndex?this.cycle.values.length:this.valueIndex)-1,this.value}},{key:"goForward",value:function(){return this.valueIndex=(this.valueIndex+1)%this.cycle.values.length,this.value}},{key:"value",get:function(){return this.cycle.values[this.valueIndex]}}]),e}()},{}],3:[function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=function(){function e(t,n){var r=this;o(this,e),this.recorder=t,this.duration=n,this.start=(new Date).getTime(),this.data=[],t.addEventListener("dataavailable",function(e){e.data.size>0&&r.data.push(e.data);var t=(new Date).getTime();t-r.start>n&&"recording"===r.recorder.state&&(r.recordingEnding(),r.recorder.stop()),r.waitingForData&&r.waitingForData()}),t.addEventListener("stop",function(e){r.onDurationMet()}),t.start(2e3)}return r(e,[{key:"getLatestBlob",value:function(){var e=this;return this.blobPromise||(this.blobPromise=new Promise(function(t,n){e.waitingForData=function(){e.blobPromise=void 0,e.waitingForData=void 0,t(e.blob)},e.recorder.requestData()})),this.blobPromise}},{key:"blob",get:function(){return 0===this.data.length?this._blob:(this._blob=this._blob?new Blob([this._blob].concat(this.data)):new Blob(this.data),this.data.splice(0),this._blob)}}]),e}();n["default"]=i},{}]},{},[1]);